# Maintainer:  Omid Nikta <omidnikta@gmail.com>
# Contributor: Omid Nikta <omidnikta@gmail.com>

pkgname=takla
pkgver=20140430
pkgrel=1
pkgdesc="Text And Keyboard Layout Analyzer."
arch=('i686' 'x86_64')
url="http://omidnikta.github.io/takla/"
license=('GPL3')
depends=('qt4')
makedepends=('git')
provides=('takla')
install=takla.install
url="http://omidnikta.github.io/takla/"
_gitroot='git://github.com/omidnikta/takla.git'
_gitname="master"

build() {
	cd ${srcdir}
	
	msg "Connecting to the GIT server...."
	if [ -d ${_gitname} ] ; then
		cd ${_gitname} && git pull origin master && cd ..
		msg "The local files are updated."
	else
		git clone ${_gitroot} --single-branch ${_gitname}
	fi

	msg "Starting make..."

	qmake-qt4 ${srcdir}/${_gitname}
	make clean
	make

} 
 
package() {
  # binary
  install -D -m755 ${srcdir}/${pkgname} ${pkgdir}/usr/bin/${pkgname}

  cd ${srcdir}/${_gitname}
  # documentation & manual
  install -d ${pkgdir}/usr/share/doc/${pkgname}
  install -d ${pkgdir}/usr/share/doc/${pkgname}/Layouts
  cp -r Manual/README.pdf ${pkgdir}/usr/share/doc/${pkgname}
  cp -r Layouts/ ${pkgdir}/usr/share/doc/${pkgname}/

  # icon
  install -D -m644 Images/takla512.png \
    ${pkgdir}/usr/share/pixmaps/takla.png

  # desktop
  install -D -m644 ${pkgname}.desktop \
    ${pkgdir}/usr/share/applications/${pkgname}.desktop
}
 